<!DOCTYPE html>

<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Yeni Yƒ±l Mektubu ‚ú®</title>
<style>
    :root{
      --bg1:#02030a;
      --bg2:#060a1a;
      --bg3:#08112a;

      --shadow: 0 28px 90px rgba(0,0,0,.55);
      --soft: 0 16px 50px rgba(0,0,0,.35);

      --px: 0px; /* moon parallax */
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      height:100svh;
      min-height:100dvh;
      overflow:hidden;
      overscroll-behavior: none;
      -webkit-tap-highlight-color: transparent;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:white;
      background:
        radial-gradient(1100px 800px at 55% 15%, rgba(120,170,255,.10), transparent 56%),
        radial-gradient(900px 700px at 20% 80%, rgba(255,255,255,.05), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2) 55%, var(--bg3));
    }

    /* layers */
    .stars, #snowBack, #snowFront, .moon-wrap, .glow, .wrap{ position:fixed; inset:0; }
    
    .wrap{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; padding: min(24px, 4vw); }
.stars{ z-index:1; pointer-events:none; }
    #snowBack{ z-index:2; pointer-events:none; }
    .moon-wrap{ z-index:3; pointer-events:none; }
    #snowFront{ z-index:4; pointer-events:none; }
    .glow{ z-index:0; pointer-events:none; }
    .wrap{ z-index:5; position:relative; display:grid; place-items:center; min-height:100dvh; padding: calc(14px + env(safe-area-inset-top)) calc(14px + env(safe-area-inset-right)) calc(14px + env(safe-area-inset-bottom)) calc(14px + env(safe-area-inset-left)); }

    /* stars */
    .stars{
      background-image:
        radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.6) 0 1px, transparent 2px),
        radial-gradient(1px 1px at 30% 80%, rgba(255,255,255,.5) 0 1px, transparent 2px),
        radial-gradient(1px 1px at 70% 35%, rgba(255,255,255,.6) 0 1px, transparent 2px),
        radial-gradient(1px 1px at 85% 75%, rgba(255,255,255,.45) 0 1px, transparent 2px),
        radial-gradient(1px 1px at 55% 10%, rgba(255,255,255,.5) 0 1px, transparent 2px);
      opacity:.5;
    }

    /* subtle glow */
    .glow{
      left:-30vw;
      top:auto;
      bottom:-35vh;
      width:80vw;
      height:80vw;
      background: radial-gradient(circle, rgba(255,255,255,.05), transparent 60%);
    }

    /* üåô MOON */
    .moon-wrap{
      left:50%;
      top:6vh;
      width:220px;
      height:220px;
      transform: translateX(calc(-50% + var(--px)));
      pointer-events:none;
      opacity:.96;
      transition: filter 450ms ease;
    }

    .moon{
      width:100%;
      height:100%;
      border-radius:50%;
      position:relative;
      background:
        radial-gradient(circle at 34% 32%,
          rgba(255,255,255,1) 0 26%,
          rgba(235,242,255,.96) 44%,
          rgba(180,205,255,.55) 70%,
          rgba(120,160,255,.10) 100%
        );
      box-shadow:
        inset -26px -30px 60px rgba(50,80,140,.30),
        inset 10px 14px 22px rgba(255,255,255,.18),
        inset -4px -6px 12px rgba(0,0,0,.10);

      -webkit-mask-image:
        radial-gradient(circle at 47% 42%, #000 58%, transparent 61%),
        radial-gradient(circle at 61% 42%, transparent 54%, #000 56%);
      -webkit-mask-composite: source-in;

      mask-image:
        radial-gradient(circle at 47% 42%, #000 58%, transparent 61%),
        radial-gradient(circle at 61% 42%, transparent 54%, #000 56%);
      mask-composite: intersect;

      transform: rotate(-14deg);
      filter: blur(.12px);
    }

    .moon::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius:50%;
      background: radial-gradient(circle at 55% 45%, rgba(0,0,0,.22), transparent 60%);
      mix-blend-mode: multiply;
      opacity:.62;
      pointer-events:none;
    }

    .moon::after{
      content:"";
      position:absolute;
      inset:-10%;
      border-radius:50%;
      background: radial-gradient(circle at 28% 30%,
        rgba(255,255,255,.22),
        rgba(255,255,255,.08),
        transparent 62%
      );
      filter: blur(10px);
      opacity:.9;
      pointer-events:none;
      transition: opacity 450ms ease;
    }

    /* ‚ú® open -> moon glow pulse */
    body.opened .moon-wrap{
      filter:
        drop-shadow(0 0 18px rgba(245,250,255,.28))
        drop-shadow(0 0 90px rgba(170,210,255,.22));
    }
    body.opened .moon::after{
      opacity: 1;
      animation: moonPulse 1.6s ease-in-out infinite;
    }
    @keyframes moonPulse{
      0%,100%{ transform: scale(1); opacity: .9; }
      50%{ transform: scale(1.02); opacity: 1; }
    }

    /* envelope container */
    .scene{
      width:min(640px, 94vw);
      position:relative;
      padding-top: clamp(180px, 26vh, 233px);
    }

    .envelope{
      position:relative;
      margin:0 auto;
      width:min(560px, 94vw);
      height:340px;
      border-radius:22px;
      background: linear-gradient(180deg, rgba(246,243,237,.90), rgba(225,232,240,.78));
      box-shadow: var(--shadow);
      border:1px solid rgba(255,255,255,.28);
      overflow:hidden;
      transform: translateZ(0);
      transition: transform 900ms cubic-bezier(.2,.9,.15,1);
    }

    .envelope::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(900px 400px at 30% 20%, rgba(255,255,255,.35), transparent 60%),
        radial-gradient(900px 450px at 70% 80%, rgba(0,0,0,.05), transparent 65%);
      opacity:.55;
      pointer-events:none;
      z-index:0;
    }
    /* üå∏ Floral background inside envelope */
.floral{
  position:absolute;
  inset:0;
  z-index:1;            /* envelope::before (0) √ºst√º, katlamalar(4+) altƒ± */
  pointer-events:none;
  opacity:.0;
  transform: translateY(14px) scale(.98);
  filter: blur(.2px) saturate(.92);
  transition: opacity 700ms ease, transform 900ms cubic-bezier(.2,.9,.15,1);
}

.floral-svg{
  position:absolute;
  left:0; right:0;
  bottom:-10px;
  width:100%;
  height:58%;
  opacity:.85;
  filter: blur(.15px);
}

/* slight paper grain look */
.floral::after{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(600px 240px at 30% 55%, rgba(0,0,0,.05), transparent 60%),
    radial-gradient(700px 260px at 70% 60%, rgba(0,0,0,.04), transparent 62%);
  opacity:.35;
  mix-blend-mode: multiply;
  pointer-events:none;
}

/* on open: florals gently appear */
.opening .floral,
.opened .floral{
  opacity:.85;
  transform: translateY(0) scale(1);
}

    /* üéÑ Decorations layer */
    .decor{
      position:absolute; inset:0;
      z-index:6;
      pointer-events:none;
    }

    /* --- string lights (soft colored twinkle) --- */
    .lights{
      position:absolute;
      left:18px; right:18px;
      top:16px;
      height:52px;
      opacity:.95;
      filter: drop-shadow(0 10px 16px rgba(0,0,0,.18));
    }
    .lights::before{
      content:"";
      position:absolute;
      left:0; right:0;
      top:20px;
      height:2px;
      background: rgba(0,0,0,.16);
      border-radius:999px;
      opacity:.55;
      transform: rotate(-1deg);
    }

    .bulb{
      position:absolute;
      top:24px;
      width:12px; height:12px;
      border-radius:50%;
      /* color from --h */
      background: hsla(var(--h, 40), 85%, 72%, .88);
      box-shadow: 0 0 16px hsla(var(--h, 40), 95%, 75%, .20);
      opacity:.55;
      animation: twinkle var(--dur, 4.2s) ease-in-out infinite;
      animation-delay: var(--d, 0s);
    }
    .bulb::after{
      content:"";
      position:absolute;
      left:50%; top:-6px;
      transform: translateX(-50%);
      width:10px; height:8px;
      border-radius:6px 6px 3px 3px;
      background: rgba(0,0,0,.14);
    }

    @keyframes twinkle{
      0%,100%{
        opacity:.45;
        transform: translateY(0) scale(1);
        box-shadow: 0 0 14px hsla(var(--h,40), 95%, 75%, .14);
      }
      50%{
        opacity:.95;
        transform: translateY(-1px) scale(1.06);
        box-shadow: 0 0 22px hsla(var(--h,40), 95%, 75%, .32);
      }
    }

    /* --- NEW: banner (fills top area nicely) --- */
    .banner{
      position:absolute;
      left:50%;
      top:62px;
      transform: translateX(-50%) rotate(-1.2deg);
      padding:7px 14px;
      border-radius:999px;
      background: rgba(0,0,0,.12);
      border:1px solid rgba(0,0,0,.10);
      color: rgba(30,30,30,.82);
      font-weight:750;
      font-size:12px;
      letter-spacing:.6px;
      text-transform: uppercase;
      backdrop-filter: blur(3px);
    }
    .banner::before, .banner::after{
      content:"";
      position:absolute;
      top:50%;
      width:18px;
      height:10px;
      background: rgba(0,0,0,.10);
      transform: translateY(-50%) skewX(-18deg);
      border-radius:6px;
      opacity:.35;
    }
    .banner::before{ left:-14px; }
    .banner::after{ right:-14px; }

    /* --- NEW: embossed year --- */
    .emboss{
      position:absolute;
      left:50%;
      top:96px;
      transform: translateX(-50%);
      font-weight:800;
      font-size:34px;
      letter-spacing:2px;
      color: rgba(255,255,255,.55);
      text-shadow:
        0 1px 0 rgba(255,255,255,.65),
        0 -1px 0 rgba(0,0,0,.10),
        0 10px 22px rgba(0,0,0,.12);
      mix-blend-mode: multiply;
      opacity:.55;
      user-select:none;
    }

    /* --- NEW: candy cane sticker --- */
    .candy{
      position:absolute;
      left:18px;
      top:68px;
      width:44px;
      height:44px;
      transform: rotate(-14deg);
      filter: drop-shadow(0 14px 18px rgba(0,0,0,.16));
      opacity:.95;
    }
    .candy::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius:999px;
      background:
        radial-gradient(circle at 35% 30%, rgba(255,255,255,.55), transparent 55%),
        repeating-linear-gradient(135deg,
          rgba(255,90,110,.95) 0 8px,
          rgba(255,255,255,.92) 8px 16px
        );
      clip-path: path("M20 4 C10 4 6 12 6 18 C6 27 16 27 16 35 C16 39 13 41 10 41 C7 41 4 39 4 36 L4 33 L0 33 L0 36 C0 42 5 46 10 46 C16 46 21 42 21 35 C21 24 11 24 11 18 C11 14 14 9 20 9 C26 9 30 14 30 20 L35 20 C35 11 29 4 20 4 Z");
    }
    /* fallback if clip-path path unsupported: simple cane */
    @supports not (clip-path: path("M0 0 L1 1")){
      .candy::before{
        clip-path: polygon(45% 0, 65% 0, 65% 55%, 85% 55%, 85% 75%, 65% 75%, 65% 100%, 45% 100%, 45% 55%, 25% 55%, 25% 35%, 45% 35%);
        border-radius:10px;
      }
    }

    /* --- NEW: tiny stickers (snowflakes & stars) --- */
    .sticker{
      position:absolute;
      width:18px; height:18px;
      opacity:.55;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.12));
    }
    .sticker.star{
      right:92px; top:78px;
      transform: rotate(12deg);
    }
    .sticker.snow{
      right:58px; top:106px;
      transform: rotate(-8deg);
      opacity:.45;
    }
    .sticker::before{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(circle at 35% 30%, rgba(255,255,255,.55), rgba(255,255,255,.18), transparent 70%);
      border-radius:50%;
    }
    .sticker.star::after{
      content:"";
      position:absolute; inset:2px;
      background: rgba(0,0,0,.10);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      opacity:.35;
      border-radius:4px;
    }
    .sticker.snow::after{
      content:"";
      position:absolute; inset:3px;
      background: rgba(0,0,0,.10);
      clip-path: polygon(50% 0%, 58% 18%, 78% 8%, 70% 30%, 92% 38%, 72% 46%, 92% 62%, 70% 70%, 78% 92%, 58% 82%, 50% 100%, 42% 82%, 22% 92%, 30% 70%, 8% 62%, 28% 54%, 8% 38%, 30% 30%, 22% 8%, 42% 18%);
      opacity:.35;
      border-radius:4px;
    }

    /* bow ribbon (kept) */
    .bow{
      position:absolute;
      right:18px;
      top:18px;
      width:78px;
      height:58px;
      transform: rotate(6deg);
      opacity:.95;
      filter: drop-shadow(0 14px 18px rgba(0,0,0,.18));
    }
    .bow .knot{
      position:absolute;
      left:50%; top:28px;
      transform: translate(-50%,-50%);
      width:16px; height:16px;
      border-radius:50%;
      background: linear-gradient(135deg, rgba(255,80,110,.95), rgba(255,190,120,.92));
      box-shadow: inset -2px -2px 6px rgba(0,0,0,.12);
    }
    .bow .loop{
      position:absolute;
      top:8px;
      width:34px; height:26px;
      border-radius:18px;
      background: linear-gradient(135deg, rgba(255,80,110,.92), rgba(255,190,120,.88));
      box-shadow: inset -3px -3px 10px rgba(0,0,0,.12);
    }
    .bow .loop.left{ left:6px; transform: rotate(-10deg); }
    .bow .loop.right{ right:6px; transform: rotate(10deg); }
    .bow .tail{
      position:absolute;
      left:50%; top:44px;
      transform: translateX(-50%);
      width:20px; height:18px;
      background: linear-gradient(135deg, rgba(255,80,110,.86), rgba(255,190,120,.78));
      clip-path: polygon(0 0, 100% 0, 68% 100%, 50% 70%, 32% 100%);
      border-radius:6px;
      opacity:.9;
    }

    /* holly corners (kept) */
    .holly{
      position:absolute;
      width:64px; height:44px;
      bottom:18px;
      opacity:.95;
      filter: drop-shadow(0 14px 18px rgba(0,0,0,.18));
    }
    .holly.left{ left:18px; transform: rotate(-8deg); }
    .holly.right{ right:18px; transform: rotate(10deg) scaleX(-1); }
    .leaf{
      position:absolute;
      width:34px; height:22px;
      background: linear-gradient(135deg, rgba(40,190,120,.95), rgba(10,120,80,.90));
      border-radius: 22px 22px 22px 6px;
      box-shadow: inset -3px -3px 10px rgba(0,0,0,.12);
    }
    .leaf.a{ left:2px; top:12px; transform: rotate(-18deg); }
    .leaf.b{ left:16px; top:2px; transform: rotate(12deg); }
    .berry{
      position:absolute;
      left:34px; top:18px;
      width:10px; height:10px;
      border-radius:50%;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.45), rgba(255,70,90,.95) 55%, rgba(180,20,40,.92));
      box-shadow: 0 10px 16px rgba(0,0,0,.18);
    }
    .berry::after{
      content:"";
      position:absolute;
      left:10px; top:3px;
      width:9px; height:9px;
      border-radius:50%;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.4), rgba(255,70,90,.92) 55%, rgba(180,20,40,.9));
      opacity:.95;
    }

    /* edges */
    .edge{
      position:absolute; inset:0;
      border-radius:22px;
      box-shadow: inset 0 0 0 2px rgba(0,0,0,.06);
      pointer-events:none;
      z-index:10;
    }

    /* seam */
    .seam{
      position:absolute;
      left:0; right:0;
      top:50%;
      height:2px;
      background: linear-gradient(90deg, transparent, rgba(0,0,0,.18), transparent);
      transform: translateY(-1px);
      opacity:.85;
      z-index:7;
      pointer-events:none;
    }

    .seamGlow{
      position:absolute;
      left:18%;
      right:18%;
      top:calc(50% - 12px);
      height:24px;
      background: radial-gradient(circle at 50% 50%, rgba(255,255,255,.26), transparent 62%);
      opacity:0;
      z-index:7;
      filter: blur(6px);
      pointer-events:none;
      transition: opacity 450ms ease;
    }

    /* flap */
    .flap{
      position:absolute;
      left:0; right:0;
      top:0;
      height:58%;
      transform-origin: top center;
      transform: rotateX(0deg);
      transition: transform 900ms cubic-bezier(.2,.9,.15,1);
      z-index:8;
      perspective: 900px;
    }
    .flap::before{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(248,245,239,.94), rgba(222,228,236,.88));
      clip-path: polygon(0 0, 100% 0, 50% 100%);
      border-bottom: 1px solid rgba(0,0,0,.08);
    }

    .fold-left, .fold-right{
      position:absolute;
      bottom:-2px;
      width:52%;
      height:64%;
      background: linear-gradient(180deg, rgba(248,245,239,.78), rgba(210,220,230,.74));
      opacity:.9;
      z-index:4;
    }
    .fold-left{
      left:-2px;
      clip-path: polygon(0 100%, 0 0, 100% 55%);
      border-right:1px solid rgba(0,0,0,.06);
    }
    .fold-right{
      right:-2px;
      clip-path: polygon(100% 100%, 0 55%, 100% 0);
      border-left:1px solid rgba(0,0,0,.06);
    }

    /* ‚úÖ NEW: Cute premium button */
    .open-btn{
      position:absolute;
      left:50%;
      top:50%;
      transform: translate(-50%, -50%);
      z-index:9;
      border:0;
      padding:12px 18px;
      border-radius:999px;
      cursor:pointer;
      user-select:none;

      background: linear-gradient(135deg, rgba(255,92,120,.92), rgba(255,190,120,.90));
      color: rgba(20,20,20,.88);
      font-weight:850;
      letter-spacing:.3px;

      box-shadow:
        0 16px 40px rgba(0,0,0,.25),
        inset 0 1px 0 rgba(255,255,255,.45);

      display:flex;
      align-items:center;
      gap:10px;
      transition: transform 140ms ease, filter 180ms ease;
      overflow:hidden;
    }
    .open-btn:hover{
      filter: brightness(1.03);
      transform: translate(-50%, -50%) scale(1.02);
    }
    .open-btn:active{
      transform: translate(-50%, -50%) scale(.98);
    }

    .open-ico{
      width:22px; height:22px;
      display:inline-grid;
      place-items:center;
      border-radius:999px;
      background: rgba(255,255,255,.45);
      box-shadow: inset -2px -2px 8px rgba(0,0,0,.10);
      font-size:14px;
    }

    /* button shimmer (soft) */
    .open-btn::after{
      content:"";
      position:absolute;
      top:-30%;
      left:-60%;
      width:50%;
      height:160%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.38), transparent);
      transform: rotate(18deg);
      animation: sweep 3.2s ease-in-out infinite;
      opacity:.75;
      pointer-events:none;
    }
    @keyframes sweep{
      0%{ transform: translateX(0) rotate(18deg); opacity:0; }
      18%{ opacity:.70; }
      55%{ opacity:.40; }
      100%{ transform: translateX(420%) rotate(18deg); opacity:0; }
    }

    /* sparkle burst pieces */
    .burst{
      position:absolute;
      left:50%;
      top:50%;
      width:1px; height:1px;
      z-index:9;
      pointer-events:none;
    }
    .spark{
      position:absolute;
      width:6px; height:6px;
      border-radius:50%;
      background: rgba(255,255,255,.92);
      box-shadow: 0 0 14px rgba(255,255,255,.35);
      opacity:0;
      transform: translate(0,0) scale(.6);
    }

    /* book/diary inside */
    .book-wrap{
      position:absolute;
      left:50%;
      top:52%;
      transform: translate(-50%, -50%);
      width: min(540px, 90vw);
      height: clamp(240px, 38vh, 320px);
      z-index:6;
      pointer-events:none;
    }

    .book{
      position:absolute; inset:0;
      border-radius:18px;
      transform-style: preserve-3d;
      filter: drop-shadow(0 18px 45px rgba(0,0,0,.25));
      transform: translateY(32px) scale(.92);
      opacity: 0;
      transition: opacity 600ms ease, transform 850ms cubic-bezier(.2,.9,.15,1);
    }

    .spine{
      position:absolute;
      left:50%;
      top:0;
      width:8px;
      height:100%;
      transform: translateX(-50%);
      background: linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.05));
      border-radius:99px;
      opacity:.6;
    }

    /* ‚úÖ FIX: pages no longer flip away and hide text */
    .page{
      position:absolute;
      top:0;
      width:50%;
      height:100%;
      padding:clamp(12px, 2.8vw, 18px) clamp(12px, 2.8vw, 16px);
      background: linear-gradient(180deg, rgba(247,242,232,.98), rgba(239,230,216,.95));
      color: #171717;
      border:1px solid rgba(0,0,0,.08);
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none; /* Firefox */
      backface-visibility: hidden;

      transition: transform 900ms cubic-bezier(.2,.9,.15,1) 180ms;
    }
    .page::-webkit-scrollbar{ width:0; height:0; }
    .page h2{ margin:0 0 8px 0; font-size:18px; letter-spacing:.2px; }
    .page p{ margin:0; line-height:1.5; font-size:clamp(12px, 2.9vw, 15.5px); white-space:pre-wrap; }

    /* initial: slightly "closed" */
    .page.left{
      left:0;
      border-radius:18px 6px 6px 18px;
      transform-origin: right center;
      transform: rotateY(-55deg) translateX(6px);
    }
    .page.right{
      right:0;
      border-radius:6px 18px 18px 6px;
      transform-origin: left center;
      transform: rotateY(55deg) translateX(-6px);
    }

    /* OPEN STATE */


    /* üå∏ Petals (viewport layer; should NOT be clipped by envelope) */
    .petals{
      position:fixed;
      inset:0;
      z-index:7; /* ‚úÖ above the scene so you can see them */
      pointer-events:none;
    }
    .petal{
      position:absolute;
      width:16px;
      height:22px;
      border-radius: 60% 40% 60% 40% / 55% 45% 55% 45%;
      background:
        radial-gradient(circle at 30% 25%, rgba(255,255,255,.34), transparent 55%),
        linear-gradient(180deg, rgba(255,175,195,.40), rgba(255,220,170,.20));
      opacity:0;
      filter: blur(.12px) drop-shadow(0 10px 16px rgba(0,0,0,.10));
      transform: translate3d(0,0,0) rotate(0deg);
    }
    @keyframes petalFloat{
      0%   { opacity:0; transform: translate3d(var(--x), var(--y), 0) rotate(var(--r)); }
      12%  { opacity:.78; }
      100% { opacity:0; transform: translate3d(calc(var(--x) + var(--dx)), calc(var(--y) + var(--dy)), 0) rotate(calc(var(--r) + 160deg)); }
    }

    /* üå∏ Floral background inside envelope (slightly more visible) */
    .floral{
      position:absolute;
      inset:0;
      z-index:2; /* above paper texture (0), below folds (4) and decor (6) */
      pointer-events:none;
      opacity:0;
      transform: translateY(14px) scale(.99);
      filter: blur(.12px) saturate(.95);
      transition: opacity 700ms ease, transform 900ms cubic-bezier(.2,.9,.15,1);
    }
    .floral-svg{
      position:absolute;
      left:0; right:0;
      bottom:0;
      width:100%;
      height:72%; /* ‚úÖ moved up so it's visible */
      opacity:.9;
    }
    .floral::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(600px 240px at 30% 55%, rgba(0,0,0,.05), transparent 60%),
        radial-gradient(700px 260px at 70% 60%, rgba(0,0,0,.04), transparent 62%);
      opacity:.32;
      mix-blend-mode: multiply;
      pointer-events:none;
    }
    .opening .floral,
    .opened .floral{
      opacity:.95;
      transform: translateY(0) scale(1);
    }

    .opened .flap{ transform: rotateX(-155deg); }

    .opened .open-btn{
      opacity:0;
      transform: translate(-50%, -50%) scale(.96);
      pointer-events:none;
      transition: opacity 250ms ease, transform 250ms ease;
    }

    .opened .book{
      opacity:1;
      transform: translateY(0px) scale(1);
    }

    /* opened: book is open and text stays visible */
    .opened .page.left{
      transform: rotateY(-10deg) translateX(-4px);
    }
    .opened .page.right{
      transform: rotateY(10deg) translateX(4px);
    }

    /* Premium open motion */
    .opening .envelope{ transform: translateY(-10px) scale(1.01); }
    .opened .envelope{ transform: translateY(-6px) scale(1.005); }
    .opening .seamGlow{ opacity:1; }
    .opened .seamGlow{ opacity:.75; }

    
    @media (max-height: 640px){
      .book-wrap{ height: clamp(220px, 44vh, 320px); }
      .envelope{ height: clamp(300px, 58vh, 340px); }
    }

    @media (max-width: 520px){
      .envelope{ height:320px; border-radius:18px; }
      .book-wrap{ height:230px; }
      .page p{ margin:0; line-height:1.5; font-size:clamp(12px, 2.9vw, 15.5px); white-space:pre-wrap; }
      .moon-wrap{ width:175px; height:175px; top:8.5vh; }
      .scene{ padding-top: clamp(168px, 24vh, 210px); }
      .emboss{ font-size:30px; top:92px; }
    }


  
    /* üå∏ Side florals (come from left & right on open) */
    
    /* ‚ù§Ô∏è Snowflake heart (top edge, not over text) */
    .snow-heart{
      position:absolute;
      left:50%;
      top:14px;
      transform: translateX(-50%);
      width: clamp(92px, 34vw, 150px);
      height: clamp(62px, 22vw, 108px);
      z-index: 8; /* above paper, below stickers */
      pointer-events:none;
      opacity: .95;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.18));
    }
    .snow-heart .hf{
      position:absolute;
      left:50%;
      top:50%;
      transform: translate(-50%,-50%);
      font-size: clamp(10px, 3.6vw, 16px);
      line-height: 1;
      color: rgba(255, 64, 92, .92);
      text-shadow: 0 0 10px rgba(255, 64, 92, .25);
      will-change: transform, opacity;
      animation: heartTwinkle var(--tw, 2400ms) ease-in-out infinite;
      opacity: var(--op, .92);
    }
    @keyframes heartTwinkle{
      0%,100%{ filter: brightness(1); opacity: var(--op, .92); }
      50%    { filter: brightness(1.25); opacity: calc(var(--op, .92) - .12); }
    }

.side-florals{
      position:fixed;
      inset:0;
      z-index:6; /* above scene, below petals(7) */
      pointer-events:none;
      opacity:0;
      transition: opacity 420ms ease;
    }

    .side-floral{
      position:absolute;
      top:52%;
      width:240px;
      height:360px;
      transform: translateY(-50%);
      filter: blur(.18px) saturate(.95) drop-shadow(0 24px 45px rgba(0,0,0,.18));
      opacity:.0;
    }

    .side-floral.left{
      left:-260px;
      transform: translate(-10px, -50%) rotate(-8deg);
    }
    .side-floral.right{
      right:-260px;
      transform: translate(10px, -50%) rotate(8deg) scaleX(-1);
    }

    .side-floral svg{
      width:100%;
      height:100%;
      display:block;
      filter: drop-shadow(0 18px 30px rgba(0,0,0,.22)) saturate(1.05) contrast(1.02);
    }

    .opening .side-florals,
    .opened .side-florals{
      opacity:1;
    }

    /* slide-in animation */
    .opening .side-floral.left{
      animation: sideInLeft 1500ms cubic-bezier(.18,.92,.14,1) 140ms both;
    }
    .opening .side-floral.right{
      animation: sideInRight 1500ms cubic-bezier(.18,.92,.14,1) 140ms both;
    }
    .opened .side-floral{
      opacity:.92;
    }

    .opened .side-floral.left{
      transform: translate(285px, -50%) rotate(-6deg);
      animation: floralIdle 6.5s ease-in-out infinite;
      opacity:.92;
    }
    .opened .side-floral.right{
      transform: translate(-285px, -50%) rotate(6deg) scaleX(-1);
      animation: floralIdle 6.8s ease-in-out infinite;
      opacity:.92;
    }
    @keyframes floralIdle{
      0%,100%{ transform: translate(var(--tx), -50%) rotate(var(--rot)) scaleX(var(--sx, 1)); }
      50%    { transform: translate(var(--tx), calc(-50% - 6px)) rotate(calc(var(--rot) + 1.2deg)) scaleX(var(--sx, 1)); }
    }
    .opened .side-floral.left{ --tx:285px; --rot:-6deg; --sx:1; }
    .opened .side-floral.right{ --tx:-285px; --rot:6deg; --sx:-1; }


    @keyframes sideInLeft{
      0%   { opacity:0; transform: translate(-36px, -50%) rotate(-12deg) scale(.96); }
      35%  { opacity:.90; }
      100% { opacity:.92; transform: translate(285px, -50%) rotate(-6deg) scale(1); }
    }
    @keyframes sideInRight{
      0%   { opacity:0; transform: translate(36px, -50%) rotate(12deg) scale(.96) scaleX(-1); }
      35%  { opacity:.90; }
      100% { opacity:.92; transform: translate(-285px, -50%) rotate(6deg) scale(1) scaleX(-1); }
    }

    /* slightly smaller on mobile */
    @media (max-width: 520px){
      .side-floral{ width:180px; height:300px; top:56%; }
      @keyframes sideInLeft{
        0%{ opacity:0; transform: translate(-24px, -50%) rotate(-10deg); }
        100%{ opacity:.92; transform: translate(215px, -50%) rotate(-6deg); }
      }
      @keyframes sideInRight{
        0%{ opacity:0; transform: translate(24px, -50%) rotate(10deg) scaleX(-1); }
        100%{ opacity:.92; transform: translate(-215px, -50%) rotate(6deg) scaleX(-1); }
      }
    }


    /* daisies styling */
    .daisy{ filter: blur(.06px); }


    /* üñ§ FX overlay (screen blackout + snow morph to postcard) */
    #fxCanvas{
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      z-index:20;
      pointer-events:none;
      opacity:0;
      transition: opacity 700ms ease;
    }
    body.fx #fxCanvas{ opacity:1; }
    body.fx .wrap{ opacity:0; transition: opacity 260ms ease; }
    body.fx #snowBack, body.fx #snowFront{ opacity:0.22; transition: opacity 260ms ease; }



    /* üéÑ Cute Christmas trees */
    .xmas-trees{
      position:fixed;
      inset:0;
      z-index:2;
      pointer-events:none;
    }
    .xmas-tree{
      position:absolute;
      transform-origin:50% 100%;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.45));
      text-shadow: 0 10px 18px rgba(0,0,0,.45), 0 0 14px rgba(140,255,220,.18);
      opacity:.92;
      user-select:none;
    }
    .xmas-tree.t1{ left:18px; bottom:10px; font-size:52px; transform: rotate(-6deg); }
    .xmas-tree.t2{ right:22px; bottom:12px; font-size:58px; transform: rotate(7deg) scaleX(-1); opacity:.9; }
    .xmas-tree.t3{ left:10px; bottom:120px; font-size:34px; transform: rotate(-10deg); opacity:.75; }
    .xmas-tree.t4{ right:12px; bottom:140px; font-size:36px; transform: rotate(11deg) scaleX(-1); opacity:.72; }
    .xmas-tree.t5{ left:50%; bottom:8px; font-size:40px; transform: translateX(-50%) rotate(1deg); opacity:.55; }

    /* Keep trees visible during FX, but dim them slightly */
    body.fx .xmas-trees{ opacity:.55; transition: opacity 260ms ease; }

    /* üéÑ Twinkle + gentle sway for trees */
    .tree-sway{
      position:relative;
      display:inline-block;
      transform-origin: 50% 100%;
      animation: treeSway var(--swayDur, 3.8s) ease-in-out infinite;
      will-change: transform;
    }
    @keyframes treeSway{
      0%,100%{ transform: rotate(-2.2deg); }
      50%{ transform: rotate(2.2deg); }
    }
    /* lights overlay on the tree emoji */
    .tree-sway::after{
      content:"";
      position:absolute;
      left:50%;
      top:50%;
      width:1.05em;
      height:1.15em;
      transform: translate(-50%, -55%);
      pointer-events:none;
      opacity:.92;
      mix-blend-mode: screen;
      filter: drop-shadow(0 0 10px rgba(255,255,255,.22));
      background:
        radial-gradient(circle at 40% 24%, hsla(50,100%,70%,.95) 0 2px, transparent 3px),
        radial-gradient(circle at 62% 38%, hsla(190,100%,70%,.90) 0 2px, transparent 3px),
        radial-gradient(circle at 35% 52%, hsla(320,100%,75%,.90) 0 2px, transparent 3px),
        radial-gradient(circle at 58% 60%, hsla(120,100%,70%,.85) 0 2px, transparent 3px),
        radial-gradient(circle at 48% 74%, hsla(35,100%,70%,.85) 0 2px, transparent 3px);
      animation: twinkle var(--twDur, 1.8s) ease-in-out infinite;
    }
    @keyframes twinkle{
      0%,100%{ opacity:.25; filter: drop-shadow(0 0 8px rgba(255,255,255,.15)); }
      50%{ opacity:1; filter: drop-shadow(0 0 14px rgba(255,255,255,.28)); }
    }

    /* üéÑ Mini trees on the envelope */
    .mini-trees{
      position:absolute;
      inset:0;
      z-index:10;
      pointer-events:none;
      opacity:.95;
    }
    .mini-tree{
      position:absolute;
      transform-origin: 50% 100%;
      filter: drop-shadow(0 8px 14px rgba(0,0,0,.28));
      user-select:none;
    }
    .mini-tree.mt1{ left:18px; bottom:14px; font-size:34px; --swayDur:4.2s; --twDur:1.9s; }
    .mini-tree.mt2{ right:18px; bottom:14px; font-size:34px; transform: scaleX(-1); --swayDur:4.0s; --twDur:2.1s; }
    .mini-tree.mt3{ left:16px; top:64px; font-size:22px; opacity:.82; --swayDur:4.6s; --twDur:2.2s; }
    .mini-tree.mt4{ right:16px; top:64px; font-size:22px; transform: scaleX(-1); opacity:.82; --swayDur:4.4s; --twDur:2.0s; }


    @media (max-width: 420px){
      .scene{ padding-top: clamp(160px, 23vh, 200px); }
      .envelope{ height: 320px; }
      .book-wrap{ width: min(560px, 94vw); height: clamp(260px, 46vh, 360px); top:54%; }
      .page{ overflow:auto; }
      .page::-webkit-scrollbar{ width:0; height:0; }
    .page h2{ font-size:16px; margin:0 0 8px; }
    }
    </style>
</head>
<body>
<!-- ‚ùÑÔ∏è back snow (behind moon) -->
<canvas id="snowBack"></canvas>
<div class="stars"></div>
<!-- üåô moon -->
<div aria-hidden="true" class="moon-wrap" id="moonWrap">
<div class="moon"></div>
</div>
<!-- ‚ùÑÔ∏è front snow (in front of moon) -->
<canvas id="snowFront"></canvas><div aria-hidden="true" class="xmas-trees"><div class="xmas-tree t1"><span class="tree-sway">üéÑ</span></div><div class="xmas-tree t2"><span class="tree-sway">üéÑ</span></div><div class="xmas-tree t3"><span class="tree-sway">üéÑ</span></div><div class="xmas-tree t4"><span class="tree-sway">üéÑ</span></div><div class="xmas-tree t5"><span class="tree-sway">üéÑ</span></div></div>
<!-- üñ§ FX overlay canvas (dark + snow morph) -->
<canvas aria-hidden="true" id="fxCanvas"></canvas>
<!-- üå∏ floating petals (viewport layer) -->
<div aria-hidden="true" class="petals" id="petals"></div>
<!-- üå∏ side florals (slide from left & right on open) -->
<div aria-hidden="true" class="side-florals">
<div class="side-floral left">
<svg preserveaspectratio="xMidYMid meet" viewbox="0 0 240 360">
<!-- stems -->
<path d="M40,360 C55,290 80,260 105,220 C130,180 150,140 168,92" fill="none" stroke="rgba(22,120,85,.34)" stroke-linecap="round" stroke-width="7"></path>
<path d="M70,360 C78,300 96,270 118,240 C140,210 158,175 176,132" fill="none" stroke="rgba(22,120,85,.28)" stroke-linecap="round" stroke-width="6"></path>
<path d="M95,360 C98,315 112,286 132,258 C152,230 165,205 178,172" fill="none" stroke="rgba(22,120,85,.22)" stroke-linecap="round" stroke-width="5"></path>
<!-- leaves -->
<path d="M120,210 C92,210 74,192 66,170 C92,168 112,182 124,200 Z" fill="rgba(25,160,110,.26)"></path>
<path d="M150,150 C128,148 112,134 104,116 C128,114 144,126 154,140 Z" fill="rgba(25,160,110,.22)"></path>
<path d="M165,115 C148,112 136,102 130,88 C148,86 160,94 168,106 Z" fill="rgba(25,160,110,.18)"></path>
<!-- daisies (soft, natural) -->
<g opacity="0.95">
<g class="daisy" transform="translate(178 92)">
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(30.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(60.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(90.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(120.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(150.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(180.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(210.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(240.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(270.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(300.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(330.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,210,140,0.22)" r="8.80"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="2.88"></circle>
</g>
<g class="daisy" transform="translate(152 132)">
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(32.73)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(65.45)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(98.18)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(130.91)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(163.64)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(196.36)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(229.09)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(261.82)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(294.55)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(327.27)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,200,120,0.22)" r="7.15"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="2.34"></circle>
</g>
<g class="daisy" transform="translate(140 168)">
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(36.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(72.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(108.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(144.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(180.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(216.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(252.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(288.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(324.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,210,135,0.22)" r="6.60"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="2.16"></circle>
</g>
<g class="daisy" transform="translate(196 118)">
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(36.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(72.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(108.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(144.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(180.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(216.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(252.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(288.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(324.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,205,120,0.22)" r="6.60"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="2.16"></circle>
</g>
<g class="daisy" transform="translate(168 206)">
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(40.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(80.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(120.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(160.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(200.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(240.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(280.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(320.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,215,150,0.22)" r="6.05"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="1.98"></circle>
</g>
<g class="daisy" transform="translate(118 210)">
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(40.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(80.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(120.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(160.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(200.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(240.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(280.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(320.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,215,150,0.22)" r="6.05"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="1.98"></circle>
</g>
<g class="daisy" transform="translate(190 160)">
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(40.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(80.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(120.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(160.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(200.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(240.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(280.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(320.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,210,135,0.22)" r="5.50"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="1.80"></circle>
</g>
</g>
<!-- tiny pollen specks -->
<g opacity="0.25">
<circle cx="160" cy="110" fill="rgba(255,210,140,0.7)" r="2.2"></circle>
<circle cx="172" cy="104" fill="rgba(255,210,140,0.6)" r="1.8"></circle>
<circle cx="148" cy="126" fill="rgba(255,210,140,0.5)" r="1.6"></circle>
</g>
</svg>
</div>
<div class="side-floral right">
<svg preserveaspectratio="xMidYMid meet" viewbox="0 0 240 360">
<!-- stems -->
<path d="M40,360 C55,290 80,260 105,220 C130,180 150,140 168,92" fill="none" stroke="rgba(22,120,85,.34)" stroke-linecap="round" stroke-width="7"></path>
<path d="M70,360 C78,300 96,270 118,240 C140,210 158,175 176,132" fill="none" stroke="rgba(22,120,85,.28)" stroke-linecap="round" stroke-width="6"></path>
<path d="M95,360 C98,315 112,286 132,258 C152,230 165,205 178,172" fill="none" stroke="rgba(22,120,85,.22)" stroke-linecap="round" stroke-width="5"></path>
<!-- leaves -->
<path d="M120,210 C92,210 74,192 66,170 C92,168 112,182 124,200 Z" fill="rgba(25,160,110,.26)"></path>
<path d="M150,150 C128,148 112,134 104,116 C128,114 144,126 154,140 Z" fill="rgba(25,160,110,.22)"></path>
<path d="M165,115 C148,112 136,102 130,88 C148,86 160,94 168,106 Z" fill="rgba(25,160,110,.18)"></path>
<!-- daisies (soft, natural) -->
<g opacity="0.95">
<g class="daisy" transform="translate(178 92)">
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(30.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(60.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(90.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(120.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(150.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(180.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(210.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(240.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(270.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(300.00)"></ellipse>
<ellipse cx="0" cy="-9.00" fill="rgba(255,255,255,0.2)" rx="4.00" ry="9.00" transform="rotate(330.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,210,140,0.22)" r="8.80"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="2.88"></circle>
</g>
<g class="daisy" transform="translate(152 132)">
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(32.73)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(65.45)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(98.18)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(130.91)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(163.64)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(196.36)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(229.09)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(261.82)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(294.55)"></ellipse>
<ellipse cx="0" cy="-7.50" fill="rgba(255,255,255,0.18)" rx="3.50" ry="7.50" transform="rotate(327.27)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,200,120,0.22)" r="7.15"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="2.34"></circle>
</g>
<g class="daisy" transform="translate(140 168)">
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(36.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(72.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(108.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(144.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(180.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(216.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(252.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(288.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(324.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,210,135,0.22)" r="6.60"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="2.16"></circle>
</g>
<g class="daisy" transform="translate(196 118)">
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(36.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(72.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(108.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(144.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(180.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(216.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(252.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(288.00)"></ellipse>
<ellipse cx="0" cy="-7.00" fill="rgba(255,255,255,0.16)" rx="3.25" ry="7.00" transform="rotate(324.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,205,120,0.22)" r="6.60"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="2.16"></circle>
</g>
<g class="daisy" transform="translate(168 206)">
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(40.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(80.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(120.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(160.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(200.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(240.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(280.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(320.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,215,150,0.22)" r="6.05"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="1.98"></circle>
</g>
<g class="daisy" transform="translate(118 210)">
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(40.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(80.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(120.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(160.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(200.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(240.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(280.00)"></ellipse>
<ellipse cx="0" cy="-6.50" fill="rgba(255,255,255,0.14)" rx="3.00" ry="6.50" transform="rotate(320.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,215,150,0.22)" r="6.05"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="1.98"></circle>
</g>
<g class="daisy" transform="translate(190 160)">
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(0.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(40.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(80.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(120.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(160.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(200.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(240.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(280.00)"></ellipse>
<ellipse cx="0" cy="-6.00" fill="rgba(255,255,255,0.14)" rx="2.90" ry="6.00" transform="rotate(320.00)"></ellipse>
<circle cx="0" cy="0" fill="rgba(255,210,135,0.22)" r="5.50"></circle>
<circle cx="-2" cy="-2" fill="rgba(255,255,255,0.26)" r="1.80"></circle>
</g>
</g>
<!-- tiny pollen specks -->
<g opacity="0.25">
<circle cx="160" cy="110" fill="rgba(255,210,140,0.7)" r="2.2"></circle>
<circle cx="172" cy="104" fill="rgba(255,210,140,0.6)" r="1.8"></circle>
<circle cx="148" cy="126" fill="rgba(255,210,140,0.5)" r="1.6"></circle>
</g>
</svg>
</div>
</div>
<div aria-hidden="true" class="glow"></div>
<main class="wrap">
<div class="scene">
<section aria-label="Zarf ve mektup" class="envelope" id="envelope">
<!-- üéÑ Decorations -->
<div aria-hidden="true" class="decor">
<!-- lights (soft colored twinkle) -->
<div class="lights">
<span class="bulb" style="left:4%;  --h: 25;  --dur:4.6s; --d:-.4s;"></span>
<span class="bulb" style="left:14%; --h: 145; --dur:5.1s; --d:-1.2s;"></span>
<span class="bulb" style="left:26%; --h: 205; --dur:4.2s; --d:-.8s;"></span>
<span class="bulb" style="left:38%; --h: 330; --dur:5.4s; --d:-2.0s;"></span>
<span class="bulb" style="left:52%; --h: 40;  --dur:4.9s; --d:-1.6s;"></span>
<span class="bulb" style="left:64%; --h: 160; --dur:5.2s; --d:-.6s;"></span>
<span class="bulb" style="left:76%; --h: 220; --dur:4.4s; --d:-2.3s;"></span>
<span class="bulb" style="left:88%; --h: 305; --dur:5.6s; --d:-1.0s;"></span>
</div>
<!-- üéÑ Mini trees on the envelope -->
<div aria-hidden="true" class="mini-trees">
  <div class="mini-tree mt1"><span class="tree-sway">üéÑ</span></div>
  <div class="mini-tree mt2"><span class="tree-sway">üéÑ</span></div>
  <div class="mini-tree mt3"><span class="tree-sway">üéÑ</span></div>
  <div class="mini-tree mt4"><span class="tree-sway">üéÑ</span></div>
</div>

<!-- ‚ù§Ô∏è Snowflake heart (border top center) -->
<div aria-hidden="true" class="snow-heart" id="snowHeart"></div>
<!-- üå∏ Floral layer (paper inside, very subtle) -->
<div aria-hidden="true" class="floral">
<svg class="floral-svg" preserveaspectratio="none" viewbox="0 0 600 260">
<!-- stems -->
<path d="M70,260 C95,205 125,175 165,135 C205,95 235,75 265,40" fill="none" stroke="rgba(22,120,85,.36)" stroke-linecap="round" stroke-width="6"></path>
<path d="M530,260 C505,205 475,175 435,135 C395,95 365,75 335,40" fill="none" stroke="rgba(22,120,85,.32)" stroke-linecap="round" stroke-width="6"></path>
<!-- leaves -->
<path d="M175,165 C145,160 126,140 118,118 C144,116 164,130 180,150 Z" fill="rgba(25,160,110,.28)"></path>
<path d="M425,165 C455,160 474,140 482,118 C456,116 436,130 420,150 Z" fill="rgba(25,160,110,.26)"></path>
<!-- flowers (watercolor-ish) -->
<g opacity="0.92">
<circle cx="270" cy="42" fill="rgba(255,150,175,.34)" r="22"></circle>
<circle cx="250" cy="58" fill="rgba(255,210,140,.24)" r="18"></circle>
<circle cx="292" cy="60" fill="rgba(255,255,255,.20)" r="16"></circle>
<circle cx="330" cy="42" fill="rgba(170,200,255,.28)" r="22"></circle>
<circle cx="310" cy="58" fill="rgba(255,190,210,.22)" r="18"></circle>
<circle cx="352" cy="60" fill="rgba(255,255,255,.18)" r="16"></circle>
</g>
<!-- small blossoms -->
<g opacity="0.75">
<circle cx="210" cy="96" fill="rgba(255,190,210,.20)" r="10"></circle>
<circle cx="390" cy="96" fill="rgba(255,210,160,.18)" r="10"></circle>
</g>
</svg>
</div>
<!-- üå∏ floating petals container (on open) -->
<div class="banner">Happy New Year</div>
<div class="emboss">2026</div>
<div class="candy"></div>
<div class="sticker star"></div>
<div class="sticker snow"></div>
<div class="bow">
<div class="loop left"></div>
<div class="loop right"></div>
<div class="knot"></div>
<div class="tail"></div>
</div>
<div class="holly left">
<div class="leaf a"></div>
<div class="leaf b"></div>
<div class="berry"></div>
</div>
<div class="holly right">
<div class="leaf a"></div>
<div class="leaf b"></div>
<div class="berry"></div>
</div>
</div>
<div aria-hidden="true" class="fold-left"></div>
<div aria-hidden="true" class="fold-right"></div>
<div aria-hidden="false" class="book-wrap">
<div class="book">
<div class="page left">
<h2>üéÑ Mutlu Yƒ±llar</h2>
<p id="leftText">Uzun uzun yazmak istemedim ama‚Ä¶ 
Birbirimizi tanƒ±yalƒ± √ßok uzun zaman olmadƒ±; yine de sanki uzun zamandƒ±r tanƒ±≈üƒ±yormu≈üuz gibi geliyor.
Bu kƒ±sa zamanda bile bana iyi gelen, y√ºz√ºm√º g√ºld√ºren bir s√ºr√º an birikti ‚ú®
</p>
</div>
<div class="page right">
<h2>‚ú® 2026</h2>
<p id="rightText">Yeni yƒ±lda da daha √ßok g√ºl√ºp, 
daha g√ºzel anƒ±lar biriktirelim isterim..

Bu yƒ±l
Bol bol g√ºlmeli
Beraber g√ºzel anƒ±larla dolu seneler diliyorum üñ§


</p>
</div>
<div aria-hidden="true" class="spine"></div>
</div>
</div>
<div aria-hidden="true" class="seamGlow"></div>
<div aria-hidden="true" class="seam"></div>
<button aria-label="Mektubu a√ß" class="open-btn" id="openBtn" type="button">
<span class="open-ico">üéÅ</span>
          A√ß
        </button>
<div aria-hidden="true" class="burst" id="burst"></div>
<div aria-hidden="true" class="flap"></div>
<div aria-hidden="true" class="edge"></div>
</section>
</div>
</main>
<script>
    /* ---------------------------
      ‚ùÑÔ∏è TWO-LAYER SNOW (depth)
    ---------------------------- */
    function makeSnow(canvas, opts){
      const ctx = canvas.getContext("2d", { alpha:true });

      let dpr;
      function resize(){
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        canvas.width = Math.floor(window.innerWidth * dpr);
        canvas.height = Math.floor(window.innerHeight * dpr);
        canvas.style.width = window.innerWidth + "px";
        canvas.style.height = window.innerHeight + "px";
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }
      resize();

      const flakes = [];
      const rand = (a,b)=>Math.random()*(b-a)+a;

      for(let i=0;i<opts.count;i++){
        flakes.push({
          x: rand(0, window.innerWidth),
          y: rand(0, window.innerHeight),
          r: rand(opts.rMin, opts.rMax),
          vx: rand(opts.vxMin, opts.vxMax),
          vy: rand(opts.vyMin, opts.vyMax),
          wobble: rand(0, Math.PI*2),
          wobbleSpeed: rand(opts.wobbleMin, opts.wobbleMax),
          o: rand(opts.oMin, opts.oMax)
        });
      }

      function step(){
        ctx.clearRect(0,0,window.innerWidth, window.innerHeight);

        for(const f of flakes){
          f.wobble += f.wobbleSpeed;
          f.x += f.vx + Math.sin(f.wobble) * opts.wobbleAmp;
          f.y += f.vy;

          if(f.y - f.r > window.innerHeight){
            f.y = -10;
            f.x = rand(0, window.innerWidth);
          }
          if(f.x < -20) f.x = window.innerWidth + 20;
          if(f.x > window.innerWidth + 20) f.x = -20;

          ctx.beginPath();
          ctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
          ctx.closePath();
          ctx.fillStyle = `rgba(255,255,255,${f.o})`;
          ctx.fill();
        }
        requestAnimationFrame(step);
      }

      window.addEventListener("resize", () => resize(), { passive:true });
      step();
    }

    makeSnow(document.getElementById("snowBack"), {
      count: Math.round(Math.min(140, Math.max(80, window.innerWidth/10))),
      rMin: 0.6, rMax: 2.2,
      vxMin: -0.18, vxMax: 0.20,
      vyMin: 0.45, vyMax: 1.25,
      wobbleMin: 0.006, wobbleMax: 0.015,
      wobbleAmp: 0.18,
      oMin: 0.18, oMax: 0.55
    });

    makeSnow(document.getElementById("snowFront"), {
      count: Math.round(Math.min(220, Math.max(120, window.innerWidth/6))),
      rMin: 1.2, rMax: 3.4,
      vxMin: -0.28, vxMax: 0.32,
      vyMin: 0.75, vyMax: 2.25,
      wobbleMin: 0.010, wobbleMax: 0.022,
      wobbleAmp: 0.26,
      oMin: 0.22, oMax: 0.90
    });

    /* ---------------------------
      üåô Moon parallax drift (only X)
    ---------------------------- */
    const state = { tx:0, targetX:0, t:0 };

    function setTargetFromPointer(nx){
      const maxX = 16; // px
      state.targetX = nx * 2 * maxX;
    }

    window.addEventListener("mousemove", (e)=>{
      const nx = (e.clientX / window.innerWidth) - 0.5;
      setTargetFromPointer(nx);
    }, { passive:true });

    window.addEventListener("deviceorientation", (e)=>{
      if(e.gamma == null) return;
      const nx = Math.max(-0.5, Math.min(0.5, (e.gamma || 0) / 60));
      setTargetFromPointer(nx);
    }, { passive:true });

    function animateMoon(){
      state.t += 0.016;
      const idleX = Math.sin(state.t * 0.45) * 6;

      state.tx += (state.targetX - state.tx) * 0.06;
      document.documentElement.style.setProperty("--px", (state.tx + idleX).toFixed(2) + "px");

      requestAnimationFrame(animateMoon);
    }
    animateMoon();

    /* ---------------------------
      ‚ú® Sparkle burst on open
    ---------------------------- */
    const burst = document.getElementById("burst");
    function doBurst(){
      burst.innerHTML = "";
      const count = 12;
      for(let i=0;i<count;i++){
        const s = document.createElement("div");
        s.className = "spark";
        const angle = (Math.PI * 2) * (i / count);
        const dist = 44 + Math.random()*22;
        const dx = Math.cos(angle) * dist;
        const dy = Math.sin(angle) * dist;
        
        s.animate([
          { transform:`translate(0px,0px) scale(.6)`, opacity:0 },
          { opacity:1, offset:0.15 },
          { transform:`translate(${dx}px,${dy}px) scale(1)`, opacity:0 }
        ], { duration: 650, easing: "cubic-bezier(.2,.9,.2,1)" });

        burst.appendChild(s);
      }
    }
    // üå∏ Petal spawn (natural, few pieces)
const petals = document.getElementById("petals");

function spawnPetals(){
  if(!petals) return;
  petals.innerHTML = "";

  const count = 10; // az tutuyoruz -> doƒüal
  for(let i=0;i<count;i++){
    const p = document.createElement("div");
    p.className = "petal";

    // start around envelope area
    const startX = (window.innerWidth * 0.5) + (Math.random()*240 - 120);
    const startY = (window.innerHeight * 0.52) + (Math.random()*120 - 80);

    const dx = (Math.random()*260 - 130) + "px";
    const dy = (120 + Math.random()*240) + "px";
    const r  = (Math.random()*120 - 60) + "deg";

    p.style.setProperty("--x", startX + "px");
    p.style.setProperty("--y", startY + "px");
    p.style.setProperty("--dx", dx);
    p.style.setProperty("--dy", dy);
    p.style.setProperty("--r", r);

    // slight size variance
    const s = 0.85 + Math.random()*0.7;
    p.style.width = (16*s).toFixed(1) + "px";
    p.style.height = (22*s).toFixed(1) + "px";

    // color variance (very soft)
    const hue = 330 + Math.random()*50; // pink -> peach
    p.style.background =
      `radial-gradient(circle at 30% 25%, rgba(255,255,255,.34), transparent 55%),
       linear-gradient(180deg, hsla(${hue},90%,78%,.38), hsla(${hue-30},90%,80%,.18))`;

    // animation timing
    const dur = 1800 + Math.random()*900;
    const delay = Math.random()*180;

    p.style.animation = `petalFloat ${dur}ms cubic-bezier(.2,.9,.2,1) ${delay}ms 1`;

    petals.appendChild(p);
  }

  // cleanup
  setTimeout(()=>{ petals.innerHTML=""; }, 3200);
}

    /* ---------------------------
      Open interaction (premium)
    ---------------------------- */
    const env = document.getElementById("envelope");
    const btn = document.getElementById("openBtn");

    // ‚ù§Ô∏è build snowflake heart (red) on the envelope top edge (not over text)
    (function buildSnowHeart(){
      const holder = document.getElementById("snowHeart");
      if(!holder) return;
      holder.innerHTML = "";
      const N = 36;
      // heart param eq -> normalize to holder box
      const pts = [];
      for(let i=0;i<N;i++){
        const t = (Math.PI*2) * (i/(N));
        const x = 16 * Math.pow(Math.sin(t), 3);
        const y = 13*Math.cos(t) - 5*Math.cos(2*t) - 2*Math.cos(3*t) - Math.cos(4*t);
        pts.push({x, y});
      }
      // normalize
      const xs = pts.map(p=>p.x), ys = pts.map(p=>p.y);
      const minX=Math.min(...xs), maxX=Math.max(...xs);
      const minY=Math.min(...ys), maxY=Math.max(...ys);
      const w = maxX-minX, h = maxY-minY;
      // place
      pts.forEach((p, i)=>{
        const s = document.createElement("span");
        s.className = "hf";
        s.textContent = "‚ùÑ";
        const nx = (p.x - minX)/w;          // 0..1
        const ny = 1 - (p.y - minY)/h;      // flip
        // center and pad
        const px = (nx*100);
        const py = (ny*100);
        const op = 0.78 + Math.random()*0.18;
        const tw = 1800 + Math.random()*1600;
        s.style.left = px + "%";
        s.style.top  = py + "%";
        s.style.setProperty("--op", op.toFixed(2));
        s.style.setProperty("--tw", tw.toFixed(0)+"ms");
        // tiny random drift so it feels "snow-ish"
        const dx = (Math.random()*6 - 3);
        const dy = (Math.random()*6 - 3);
        s.style.transform = `translate(-50%,-50%) translate(${dx}px,${dy}px) rotate(${Math.random()*30-15}deg)`;
        holder.appendChild(s);
      });
    })();

    let openingLocked = false;

    function openEnvelope(){
      document.body.classList.add("opening");
      env.classList.add("opening");

      doBurst();
      spawnPetals();

      setTimeout(() => {
        env.classList.add("opened");
        document.body.classList.add("opened");
      }, 260);

      setTimeout(() => {
        document.body.classList.remove("opening");
        env.classList.remove("opening");
      }, 1100);
    }

    btn.addEventListener("click", () => {
      if(openingLocked || env.classList.contains("opened")) return;
      openingLocked = true;

      // prevent double taps during FX
      btn.disabled = true;

      // first: blackout + snow gathers into postcard
      runFxSequence(() => {
        // then: normal opening animation
        requestAnimationFrame(openEnvelope);
      });
    });

    /* ---------------------------
      üñ§ Screen FX: blackout -> snow only -> flakes gather into postcard -> reveal
    ---------------------------- */
    const fxCanvas = document.getElementById("fxCanvas");
    const fxCtx = fxCanvas.getContext("2d", { alpha:true });

    function fxResize(){
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      fxCanvas.width = Math.floor(window.innerWidth * dpr);
      fxCanvas.height = Math.floor(window.innerHeight * dpr);
      fxCanvas.style.width = window.innerWidth + "px";
      fxCanvas.style.height = window.innerHeight + "px";
      fxCtx.setTransform(dpr,0,0,dpr,0,0);
    }
    window.addEventListener("resize", fxResize, { passive:true });
    fxResize();

    function buildPostcardTargets(){
      const off = document.createElement("canvas");
      off.width = Math.floor(window.innerWidth);
      off.height = Math.floor(window.innerHeight);
      const c = off.getContext("2d");

      const cardW = Math.min(560, window.innerWidth * 0.86);
      const cardH = Math.min(340, window.innerHeight * 0.38);
      const cx = window.innerWidth * 0.5;
      const cy = window.innerHeight * 0.58;

      const x = cx - cardW/2;
      const y = cy - cardH/2;

      c.clearRect(0,0,off.width,off.height);
      c.fillStyle = "rgba(255,255,255,1)";

      const r = 24;
      c.beginPath();
      c.moveTo(x+r, y);
      c.arcTo(x+cardW, y, x+cardW, y+cardH, r);
      c.arcTo(x+cardW, y+cardH, x, y+cardH, r);
      c.arcTo(x, y+cardH, x, y, r);
      c.arcTo(x, y, x+cardW, y, r);
      c.closePath();
      c.fill();

      c.beginPath();
      c.moveTo(x, y);
      c.lineTo(x+cardW, y);
      c.lineTo(cx, y+cardH*0.56);
      c.closePath();
      c.fill();

      const img = c.getImageData(0,0,off.width,off.height).data;
      const targets = [];
      const step = 6;
      for(let py=0; py<off.height; py+=step){
        for(let px=0; px<off.width; px+=step){
          const a = img[(py*off.width + px)*4 + 3];
          if(a > 200) targets.push({ x:px, y:py });
        }
      }
      for(let i=targets.length-1; i>0; i--){
        const j = (Math.random() * (i+1)) | 0;
        const tmp = targets[i];
        targets[i] = targets[j];
        targets[j] = tmp;
      }
      return targets;
    }

    function runFxSequence(done){
      // Soft blackout + snow-only swirl that gathers into the postcard silhouette
      document.body.classList.add("fx");

      const targets = buildPostcardTargets();
      const particles = [];

      // how many particles
      const count = Math.min(1200, Math.max(760, Math.round(window.innerWidth * 1.10)));

      const cx = window.innerWidth * 0.5;
      const cy = window.innerHeight * 0.5;

      // Phase A: come from all sides, while rotating towards center
      // Phase B: lock into postcard silhouette (existing gather logic)
      const approachFor = 2400;  // ms (slightly faster than v4)
      const gatherFor   = 2600;  // ms
      const holdFor     = 900;   // ms

      // Approach "target radius" before morphing to postcard
      const midR = Math.min(window.innerWidth, window.innerHeight) * 0.22;

      // Global angular speed (radians/sec) during approach
      const omega = 2.15; // gentle, visible rotation

      function randEdgePos(){
        const w = window.innerWidth, h = window.innerHeight;
        const side = Math.floor(Math.random()*4); // 0 top, 1 right, 2 bottom, 3 left
        const pad = 16;
        if(side === 0) return { x: Math.random()*w, y: -pad };
        if(side === 1) return { x: w + pad, y: Math.random()*h };
        if(side === 2) return { x: Math.random()*w, y: h + pad };
        return { x: -pad, y: Math.random()*h };
      }

      for(let i=0;i<count;i++){
        const t = targets[i % targets.length];

        const e = randEdgePos();
        const sx = e.x, sy = e.y;

        const a0 = Math.atan2(sy - cy, sx - cx);
        const r0 = Math.hypot(sx - cx, sy - cy);

        particles.push({
          // appearance
          r: 0.9 + Math.random()*2.2,
          o: 0.22 + Math.random()*0.70,

          // approach state
          a0,
          r0,
          dir: (Math.random() < 0.5) ? -1 : 1,
          phase: Math.random()*Math.PI*2,
          wob: Math.random()*Math.PI*2,
          ws: 0.030 + Math.random()*0.060,

          // gather targets
          sx: sx, sy: sy,
          tx: t.x, ty: t.y,

          // lock-in swirl (phase B)
          spinPhase: Math.random()*Math.PI*2,
          spinTurns: 0.85 + Math.random()*0.75,
          spinAmp:   90  + Math.random()*155,
          spinDir:   (Math.random() < 0.5) ? -1 : 1,

          // current pos
          x: sx, y: sy
        });
      }

      const t0 = performance.now();
      let phaseBStart = null; // when we start morphing to postcard

      function frame(now){
        const t = now - t0;
        fxCtx.clearRect(0,0,window.innerWidth, window.innerHeight);

        // draw a not-too-dark veil
        fxCtx.fillStyle = "rgba(0,0,0,0.55)";
        fxCtx.fillRect(0,0,window.innerWidth, window.innerHeight);

        // Phase A: approach (from edges, rotating inward)
        if(t < approachFor){
          const u = t / approachFor;
          const ease = u<0.5 ? (2*u*u) : (1 - Math.pow(-2*u+2,2)/2); // easeInOutQuad

          for(const p of particles){
            const wobR = 10*Math.sin(p.wob + t*0.001*p.ws) + 6*Math.sin(p.phase + t*0.0012);

            const rr = (1-ease)*p.r0 + ease*midR;
            const aa = p.a0 + p.dir * omega * (t/1000) + 0.18*Math.sin(p.phase + u*6.0);

            const x = cx + Math.cos(aa) * (rr + wobR);
            const y = cy + Math.sin(aa) * (rr + wobR*0.8);

            p.x = x; p.y = y;

            fxCtx.beginPath();
            fxCtx.arc(x, y, p.r, 0, Math.PI*2);
            fxCtx.fillStyle = `rgba(255,255,255,${p.o * (0.62)})`;
            fxCtx.fill();
          }

          requestAnimationFrame(frame);
          return;
        }

        // Phase B: gather into postcard silhouette with a swirl
        if(phaseBStart === null){
          phaseBStart = now;
          // snapshot current positions as gather start
          for(const p of particles){
            p.sx = p.x; p.sy = p.y;
          }
        }

        const tb = now - phaseBStart;
        const k = Math.min(1, tb / gatherFor);
        const easeB = 1 - Math.pow(1 - k, 3); // easeOutCubic

        for(let i=0;i<particles.length;i++){
          const p = particles[i];

          // interpolate to target
          const gx = p.sx + (p.tx - p.sx) * easeB;
          const gy = p.sy + (p.ty - p.sy) * easeB;

          // swirl towards final position
          const ang = (p.spinPhase + (Math.PI*2) * p.spinTurns * k) * p.spinDir;
          const amp = (1-k) * p.spinAmp;

          const x = gx + Math.cos(ang) * amp;
          const y = gy + Math.sin(ang) * amp * 0.72;

          fxCtx.beginPath();
          fxCtx.arc(x, y, p.r, 0, Math.PI*2);
          fxCtx.fillStyle = `rgba(255,255,255,${p.o * (0.55 + 0.40*k)})`;
          fxCtx.fill();
        }

        if(tb > gatherFor + holdFor){
          document.body.classList.remove("fx");
          // Let the FX canvas fade out before opening the envelope
          setTimeout(() => { done && done(); }, 560);
          return;
        }

        requestAnimationFrame(frame);
      }

      requestAnimationFrame(frame);
    }


    /* link text optional */
    (function(){
      const params = new URLSearchParams(location.search);
      const l = params.get("l");
      const r = params.get("r");
      if(l) document.getElementById("leftText").textContent = l.slice(0, 3000);
      if(r) document.getElementById("rightText").textContent = r.slice(0, 3000);
    })();
  </script>
</body>
</html>
